"use strict";(self.webpackChunkmanic_so_blog=self.webpackChunkmanic_so_blog||[]).push([[196],{8801:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>h,contentTitle:()=>r,default:()=>l,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var a=t(4848),n=t(8453);const o={layout:"post",title:"Have I Been Pwned + Password-store",date:new Date("2018-10-28T18:21:00.000Z"),authors:"manila",tags:["programming","privacy"]},r=void 0,i={permalink:"/2018/10/28/hibp-pass",source:"@site/posts/2018-10-28-hibp-pass.md",title:"Have I Been Pwned + Password-store",description:"I use password-store by ZX2C4 as my password manager of choice.",date:"2018-10-28T18:21:00.000Z",formattedDate:"October 28, 2018",tags:[{label:"programming",permalink:"/tags/programming"},{label:"privacy",permalink:"/tags/privacy"}],readingTime:1.97,hasTruncateMarker:!1,authors:[{name:"Manuel Nila",url:"https://github.com/manila",imageURL:"https://gravatar.com/avatar/e03029db2dd81fca02a68bd402707068a80554bfedc825f5ae28cae1221977e3?size=256",key:"manila"}],frontMatter:{layout:"post",title:"Have I Been Pwned + Password-store",date:"2018-10-28T18:21:00.000Z",authors:"manila",tags:["programming","privacy"]},unlisted:!1,prevItem:{title:"Snake Hacks",permalink:"/2019/04/07/snake-hacks"},nextItem:{title:"Reader Mode without JavaScript",permalink:"/2018/09/27/noscript-reader"}},h={authorsImageUrls:[void 0]},d=[];function c(e){const s={a:"a",code:"code",p:"p",pre:"pre",strong:"strong",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.p,{children:["I use ",(0,a.jsx)(s.a,{href:"https://passwordstore.org",children:"password-store by ZX2C4"})," as my password manager of choice."]}),"\n",(0,a.jsxs)(s.p,{children:["I also have been following Troy Hunt's project ",(0,a.jsx)(s.a,{href:"https://haveibeenpwned.com",children:"haveibeenpwned.com"}),", this is a great tool that has received lots of praise for shining a light on just on likley it is that your credentials (emails or passwords) have already been compromised. Addionally he ",(0,a.jsx)(s.a,{href:"https://www.troyhunt.com/ive-just-launched-pwned-passwords-version-2/",children:"provides an API"})," for checking your password aginst a database of known breached passwords."]}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.a,{href:"https://blog.1password.com/finding-pwned-passwords-with-1password/",children:"Here"})," is a short  write-up about how 1Password.org has used this API to discourage the re-use of a known password."]}),"\n",(0,a.jsxs)(s.p,{children:["I decided that I needed this functionality as well, so in following the footsteps of others I built an extension for password-store that you can use to check your password using the ",(0,a.jsx)(s.a,{href:"https://haveibeenpwned.com/API/v2",children:"Have I Been Pwned: API V2"}),"."]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Wait! Isn't it unsafe to send your password to a third-party?"})}),"\n",(0,a.jsx)(s.p,{children:"Yes, absolutley.  There is however a compromise that I find personally acceptable."}),"\n",(0,a.jsx)(s.p,{children:"In short the solution is to NOT send the password in it's entirety to the API but rather hash the password and send a small piece of said hash to the API to return a list of possible hashes that match, from there you can compare the hashed password locally with the list returned from the API and verify if there is a match."}),"\n",(0,a.jsxs)(s.p,{children:["You can read a more in depth explanation ",(0,a.jsx)(s.a,{href:"https://blog.cloudflare.com/validating-leaked-passwords-with-k-anonymity/",children:"here"}),"."]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"I use password-store, how can I get this extension?"})}),"\n",(0,a.jsxs)(s.p,{children:["clone the ",(0,a.jsx)(s.a,{href:"https://github.com/manila/pass-extension-hibp",children:"pass-extension-hibp"})," repository and run ",(0,a.jsx)(s.code,{children:"make install"})]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.code,{children:"git clone https://github.com/manila/pass-extension-hibp && cd pass-extension-hibp && sudo make install"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Here is a breif rundown of the code"})}),"\n",(0,a.jsx)(s.p,{children:"After using some builtin functions in the password-store codebase to get and decrypt the password you want to check from your password store the password is immediatly SHA-1 hashed using OpenSSL"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"get_sha1() {\n\techo -n $1 | openssl sha1 | awk '{ print tolower($2) }'\n}\n"})}),"\n",(0,a.jsx)(s.p,{children:"Next we clip away the first 5 character of the password hash and include that in the API request URL."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"curl -s https://api.pwnedpasswords.com/range/${password_hash:0:5}\n"})}),"\n",(0,a.jsx)(s.p,{children:"Then if there are any hashes containing that string of 5 characters they will be returned in a list with a pwnage count immediately followign the possible hash. We loop through the hashed that are returned and determine if any fit the bill, if so then the password has previously been pwned and is NOT safe to use."}),"\n",(0,a.jsxs)(s.p,{children:["You can explore the source on ",(0,a.jsx)(s.a,{href:"https://github.com/manila/pass-extension-hibp",children:"github"}),"."]})]})}function l(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>r,x:()=>i});var a=t(6540);const n={},o=a.createContext(n);function r(e){const s=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),a.createElement(o.Provider,{value:s},e.children)}}}]);